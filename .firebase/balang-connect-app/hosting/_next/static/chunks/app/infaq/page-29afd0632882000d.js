(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[571],{3082:function(e,a,t){Promise.resolve().then(t.t.bind(t,5878,23)),Promise.resolve().then(t.bind(t,3887)),Promise.resolve().then(t.bind(t,4225)),Promise.resolve().then(t.bind(t,6004)),Promise.resolve().then(t.bind(t,1593))},4400:function(e,a,t){"use strict";t.d(a,{K:function(){return n}}),t(3079);var s=t(2119),n=(0,s.$)("ac32f96b71e067e0163404d10e9461eed65a578c");(0,s.$)("d5433d715c243b3563085bd65dbde947c86e64a0")},3887:function(e,a,t){"use strict";t.d(a,{default:function(){return k},q:function(){return q}});var s=t(7437),n=t(3590),r=t(9501),l=t(1229),o=t(2381),i=t(670),d=t(279),c=t(3675),u=t(8245),m=t(2749),h=t(6291),x=t(5291),p=t(3448),y=t(3147),f=t(3459),j=t(9679),v=t(7107),g=t(3340),N=t(2265),b=t(5060),w=t(4400),D=t(9376),S=t(6586),I=t(158);let q=["Social Media (Facebook, Instagram, etc.)","Google Search","Friend/Family Recommendation","Previous Event Attended","Flyer/Advertisement","Mosque Announcement","Other"],P=l.Ry({donorName:l.Z_().min(2,{message:"Donor name must be at least 2 characters."}).max(50),dedicationName:l.Z_().optional(),email:l.Z_().email({message:"Please enter a valid email address."}),phone:l.Z_().min(8,{message:"Please enter a valid phone number (min. 8 digits)."}),quantity:l.oQ.number().min(1,{message:"Quantity must be at least 1 balang."}),coverDeliveryFee:l.O7().default(!1).optional(),mosqueName:l.Z_({required_error:"Please select a mosque."}),deliveryDate:l.hT({required_error:"Please select a delivery date."}),message:l.Z_().max(300,{message:"Message cannot exceed 300 characters."}).optional(),anonymous:l.O7().default(!1).optional(),howHeard:l.Z_({required_error:"Please select how you heard about us."}),consent:l.O7().refine(e=>!0===e,{message:"You must agree to the terms to submit."}),targetSlotId:l.Z_().optional()});function k(){let{toast:e}=(0,g.pm)(),a=(0,D.useRouter)(),t=(0,D.useSearchParams)(),[l,k]=(0,N.useState)(!1),[C,F]=(0,N.useState)(0),[Z,W]=(0,N.useState)(0),[A,T]=(0,N.useState)(0),[z,M]=(0,N.useState)(null),V=(0,N.useRef)(null),[U,_]=(0,N.useState)([]),[J,O]=(0,N.useState)(!0);(0,N.useEffect)(()=>{(async()=>{O(!0),_((await (0,I.tN)()).map(e=>e.date)),O(!1)})()},[]);let X=(0,r.cI)({resolver:(0,n.F)(P),defaultValues:{donorName:"",dedicationName:"",email:"",phone:"",quantity:1,coverDeliveryFee:!1,mosqueName:void 0,deliveryDate:void 0,message:"",anonymous:!1,howHeard:void 0,consent:!1,targetSlotId:void 0}});(0,N.useEffect)(()=>{let e=t.get("mosqueName"),s=t.get("deliveryDate"),n=t.get("targetSlotId"),r=t.get("deliveryAlreadyCovered"),l=!1;if(e){X.setValue("mosqueName",e);let a=S.X3.find(a=>a.name===e);M(a?a.address:null),l=!0}if(s)try{let e=s.split("-").map(Number);if(3===e.length){let a=new Date(e[0],e[1]-1,e[2]);isNaN(a.getTime())?console.error("Failed to parse date from URL param:",s):(X.setValue("deliveryDate",a,{shouldValidate:!0}),l=!0)}}catch(e){console.error("Error parsing deliveryDate from URL:",e)}if(n&&(X.setValue("targetSlotId",n),X.setValue("message","Contributing to existing slot ID: ".concat(n)),l=!0),"true"===r&&(X.setValue("coverDeliveryFee",!1),l=!0),l){let e=new URL(window.location.href);e.searchParams.delete("mosqueName"),e.searchParams.delete("deliveryDate"),e.searchParams.delete("targetSlotId"),e.searchParams.delete("deliveryAlreadyCovered");let t=window.location.hash;a.replace(e.pathname+e.search+t,{scroll:!1}),"#infaq-form-actual"===t&&V.current&&V.current.scrollIntoView({behavior:"smooth",block:"start"})}},[t,a,X]);let B=X.watch("quantity"),Y=X.watch("anonymous"),E=X.watch("coverDeliveryFee");async function H(a){if(k(!0),!a.deliveryDate){e({title:"Delivery Date Missing",description:"Please select a delivery date.",variant:"destructive"}),k(!1);return}let t={...a,deliveryDate:(0,v.WU)(a.deliveryDate,"yyyy-MM-dd"),deliveryDisplayDate:(0,v.WU)(a.deliveryDate,"PPP"),pricePerBalang:95,calculatedSubtotal:C,deliveryFee:a.coverDeliveryFee?25:0,calculatedTotal:A,mosqueAddress:null!=z?z:void 0,orderType:"balang_infaq",coverDeliveryFee:!!a.coverDeliveryFee},s=await (0,w.K)(t);s.success?(e({title:"Infaq Submitted Successfully!",description:"Thank you, ".concat(a.anonymous?"Anonymous Donor":a.donorName,"! Your Infaq of ").concat(a.quantity," balang(s) for ").concat(a.mosqueName," on ").concat((0,v.WU)(a.deliveryDate,"PPP")," (Total: $").concat(A.toFixed(2),") has been received. We will contact you for confirmation. Slot ID: ").concat(s.slotId),variant:"default",duration:1e4}),X.reset({donorName:"",dedicationName:"",email:"",phone:"",quantity:1,coverDeliveryFee:!1,mosqueName:void 0,deliveryDate:void 0,message:"",anonymous:!1,howHeard:void 0,consent:!1,targetSlotId:void 0}),M(null),F(0),T(0),W(0)):e({title:"Infaq Submission Failed",description:s.message||"An unexpected error occurred. Please try again.",variant:"destructive"}),k(!1)}return(0,N.useEffect)(()=>{Y?X.setValue("donorName","Anonymous Donor"):"Anonymous Donor"===X.getValues("donorName")&&X.setValue("donorName","")},[Y,X]),(0,N.useEffect)(()=>{let e=Number(B)||0,a=95*e;F(a);let t=a,s=0;e>0&&E&&(t+=25,s=25),W(s),T(t)},[B,E]),(0,s.jsx)(i.l0,{...X,children:(0,s.jsxs)("form",{onSubmit:X.handleSubmit(H),className:"space-y-6",ref:V,id:"infaq-form-actual",children:[(0,s.jsx)(i.Wi,{control:X.control,name:"anonymous",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-row items-center space-x-3 space-y-0 rounded-md border p-4 shadow-sm bg-secondary/20",children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(u.X,{checked:a.value,onCheckedChange:a.onChange,disabled:l,id:"infaq-anonymous"})}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(i.lX,{htmlFor:"infaq-anonymous",children:"Donate Anonymously"}),(0,s.jsx)(i.pf,{children:"Your name will be recorded as 'Anonymous Donor'."})]})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"donorName",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Full Name (Donor) *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{placeholder:"The person making this contribution",...a,disabled:l||Y})}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"dedicationName",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Infaq On Behalf Of (Optional)"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{placeholder:"e.g., A loved one, family name, an organization",...a,disabled:l})}),(0,s.jsx)(i.pf,{children:"If this Infaq is dedicated to someone or a group."}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"email",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Email Address *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{type:"email",placeholder:"your.email@example.com",...a,disabled:l})}),(0,s.jsx)(i.pf,{children:"We'll send a confirmation to this email."}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"phone",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Phone Number *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{type:"tel",placeholder:"Your contact number (for WhatsApp coordination)",...a,disabled:l})}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"quantity",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Number of Balangs to Infaq *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{type:"number",min:"1",placeholder:"e.g., 1",...a,onChange:e=>{let t=parseInt(e.target.value,10);a.onChange(t>=1?t:1)},disabled:l})}),(0,s.jsxs)(i.pf,{children:["Each 23L balang is $","95.00"," (approx. 60 cups)."]}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"coverDeliveryFee",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-row items-center space-x-3 space-y-0 rounded-md border p-4 shadow-sm bg-secondary/20",children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(u.X,{id:"infaq-cover-delivery",checked:a.value,onCheckedChange:a.onChange,disabled:l||B<1})}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsxs)(i.lX,{htmlFor:"infaq-cover-delivery",className:(0,p.cn)(B<1&&"text-muted-foreground/50","cursor-pointer"),children:["Also sponsor the $","25.00"," delivery fee for this slot?"]}),(0,s.jsx)(i.pf,{className:(0,p.cn)(B<1&&"text-muted-foreground/50"),children:"If not selected, the delivery fee will be shared among all contributors. We will contact you separately for this portion of the payment."})]})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"mosqueName",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Mosque Name / Venue *"}),(0,s.jsxs)(x.Ph,{onValueChange:e=>{a.onChange(e);let t=S.X3.find(a=>a.name===e);M(t?t.address:null)},value:a.value||"",disabled:l,children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(x.i4,{children:(0,s.jsx)(x.ki,{placeholder:"Select a mosque"})})}),(0,s.jsx)(x.Bw,{children:S.X3.map(e=>(0,s.jsx)(x.Ql,{value:e.name,children:e.name},e.name))})]}),(0,s.jsx)(i.pf,{children:"Please select the mosque or venue for delivery."}),(0,s.jsx)(i.zG,{}),z&&(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-1 pt-1 border-t border-border",children:["Address: ",z]})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"deliveryDate",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-col",children:[(0,s.jsx)(i.lX,{children:"Preferred Delivery Date (Fridays Only) *"}),(0,s.jsxs)(m.J2,{children:[(0,s.jsx)(m.xo,{asChild:!0,children:(0,s.jsx)(i.NI,{children:(0,s.jsxs)(o.z,{variant:"outline",className:(0,p.cn)("w-full pl-3 text-left font-normal",!a.value&&"text-muted-foreground"),disabled:l||J,children:[a.value?(0,v.WU)(a.value,"PPP"):(0,s.jsx)("span",{children:J?"Loading dates...":"Pick a date"}),(0,s.jsx)(y.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(m.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(h.f,{mode:"single",selected:a.value,onSelect:a.onChange,disabled:[...U,{before:new Date(new Date().setHours(0,0,0,0))},{dayOfWeek:[0,1,2,3,4,6]}],initialFocus:!0})})]}),(0,s.jsx)(i.pf,{children:"Select the date you'd like the Infaq Balangs to be delivered. Deliveries are only available on Fridays."}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"howHeard",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"How did you hear about us? *"}),(0,s.jsxs)(x.Ph,{onValueChange:a.onChange,value:a.value||"",disabled:l,children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(x.i4,{children:(0,s.jsx)(x.ki,{placeholder:"Please select one"})})}),(0,s.jsx)(x.Bw,{children:q.map(e=>(0,s.jsx)(x.Ql,{value:e,children:e},e))})]}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:X.control,name:"message",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Message / Niat / On Behalf Of (Optional)"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(c.g,{placeholder:"Any special requests, messages for recipients, your Niat, or if this is on behalf of someone not covered in 'Dedication Name'.",className:"resize-y",...a,disabled:l})}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsxs)("div",{className:"p-4 border rounded-md bg-secondary/30 space-y-1 mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Balangs Subtotal:"}),(0,s.jsxs)("span",{className:"font-medium",children:["$",C.toFixed(2)]})]}),Z>0&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{children:"Delivery Fee:"}),(0,s.jsxs)("span",{className:"font-medium",children:["$",Z.toFixed(2)]})]}),(0,s.jsx)("hr",{className:"my-1 border-border"}),(0,s.jsxs)("div",{className:"flex justify-between text-lg font-bold text-primary",children:[(0,s.jsx)("span",{children:"Estimated Total:"}),(0,s.jsxs)("span",{children:["$",A.toFixed(2)]})]})]}),(0,s.jsx)(i.Wi,{control:X.control,name:"consent",render:e=>{let{field:a}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4 shadow-sm",children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(u.X,{checked:a.value,onCheckedChange:a.onChange,disabled:l,id:"infaq-consent"})}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(b._,{htmlFor:"infaq-consent",className:"cursor-pointer",children:"By submitting this form, I consent to BalangConnect using my personal data to respond to my inquiry and process my request. My data will be handled in compliance with Singapore's PDPA. I acknowledge that BalangConnect will follow up by contacting me via WhatsApp/Email. *"}),(0,s.jsx)(i.zG,{})]})]})}}),(0,s.jsx)(o.z,{type:"submit",className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",disabled:l||B<1||!X.formState.isValid,children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):(0,s.jsxs)(s.Fragment,{children:["Confirm Infaq Order ",(0,s.jsx)(j.Z,{className:"ml-2 h-4 w-4"})]})})]})})}},4225:function(e,a,t){"use strict";t.d(a,{default:function(){return j}});var s=t(7437),n=t(3145),r=t(9820),l=t(2381),o=t(9174),i=t(5255),d=t(2032),c=t(9342),u=t(6471);let m=(0,u.Z)("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var h=t(5518);let x=(0,u.Z)("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]);var p=t(5118),y=t(3448),f=t(9376);function j(e){let{slot:a}=e,t=(0,f.useRouter)();return(0,s.jsxs)(r.Zb,{className:"flex flex-col overflow-hidden shadow-lg hover:shadow-xl transition-shadow duration-300 h-full",children:[a.imageUrl&&(0,s.jsx)("div",{className:"w-full h-48",children:(0,s.jsx)(n.default,{src:a.imageUrl,alt:"Infaq for ".concat(a.mosqueName),width:600,height:400,className:"w-full h-full object-cover","data-ai-hint":a.dataAiHint||"community event"})}),(0,s.jsxs)(r.Ol,{children:[(0,s.jsx)(r.ll,{className:"font-headline text-xl text-primary mb-1.5",children:a.mosqueName}),(0,s.jsxs)(o.C,{variant:(e=>{switch(e){case"Delivery Secured - Join In!":case"Delivery Fee Sponsored!":default:return"default";case"Slot Open - Be the First!":case"Contributions Open (Shared Delivery Pending)":return"secondary";case"Contributions Welcome - Delivery Needed":return"destructive";case"Recently Fulfilled!":return"outline"}})(a.status),className:(0,y.cn)("text-xs h-fit py-1 px-2.5 mb-2 w-full flex items-center justify-center"),children:[(e=>{switch(e){case"Delivery Secured - Join In!":case"Delivery Fee Sponsored!":case"Recently Fulfilled!":return(0,s.jsx)(i.Z,{className:"h-4 w-4"});case"Contributions Welcome - Delivery Needed":return(0,s.jsx)(d.Z,{className:"h-4 w-4"});default:return(0,s.jsx)(c.Z,{className:"h-4 w-4"})}})(a.status),(0,s.jsx)("span",{className:"ml-1.5",children:a.status})]}),(0,s.jsxs)("div",{className:"text-xs text-muted-foreground space-y-0.5",children:[(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(m,{size:12,className:"mr-1.5 shrink-0"})," ",a.mosqueAddress||"Address not specified"]}),(0,s.jsxs)("p",{className:"flex items-center",children:[(0,s.jsx)(h.Z,{size:12,className:"mr-1.5 shrink-0"})," Friday, ",a.displayDate]})]})]}),(0,s.jsxs)(r.aY,{className:"flex-grow",children:[a.description&&(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description}),a.totalBalangsInfaqed&&a.totalBalangsInfaqed>0&&(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsxs)(o.C,{variant:"secondary",children:["Balangs Infaqed: ",a.totalBalangsInfaqed]})})]}),(0,s.jsx)(r.eW,{className:"flex-col items-stretch space-y-2",children:"Recently Fulfilled!"!==a.status?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l.z,{className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",onClick:()=>{let e=new URLSearchParams;e.append("mosqueName",a.mosqueName);let s=new Date(a.date).toISOString().split("T")[0];e.append("deliveryDate",s),e.append("targetSlotId",a.id),(a.isDeliveryFeeCovered||["Delivery Secured - Join In!","Delivery Fee Sponsored!"].includes(a.status))&&e.append("deliveryAlreadyCovered","true"),t.push("/infaq?".concat(e.toString(),"#infaq-form-actual"))},children:[(0,s.jsx)(x,{className:"mr-2 h-5 w-5"}),"Contribute Balang(s)"]}),!a.isDeliveryFeeCovered&&(0,s.jsxs)(l.z,{variant:"outline",className:"w-full border-green-600 text-green-600 hover:bg-green-50 hover:text-green-700",onClick:()=>{let e=new URLSearchParams;e.append("mosqueName",a.mosqueName);let s=new Date(a.date).toISOString().split("T")[0];e.append("deliveryDate",s),e.append("targetSlotId",a.id),t.push("/infaq?".concat(e.toString(),"#sponsor-form-actual"))},children:[(0,s.jsx)(p.Z,{className:"mr-2 h-5 w-5"}),"Sponsor Delivery ($25)"]})]}):(0,s.jsx)("p",{className:"text-sm text-green-600 font-semibold w-full text-center",children:"Thank you for your generosity!"})})]})}},6004:function(e,a,t){"use strict";t.d(a,{default:function(){return V}});var s=t(7437),n=t(3590),r=t(9501),l=t(1229),o=t(2381),i=t(670),d=t(279),c=t(8245),u=t(2749),m=t(6291),h=t(5291),x=t(3448),p=t(3147);let y=(0,t(6471).Z)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);var f=t(3459),j=t(9679),v=t(8198);let g={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},N=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,b=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,w=/^([+-])(\d{2})(?::?(\d{2}))?$/;function D(e){return e?parseInt(e):1}function S(e){return e&&parseFloat(e.replace(",","."))||0}let I=[31,null,31,30,31,30,31,31,30,31,30,31];function q(e){return e%400==0||e%4==0&&e%100!=0}var P=t(7107),k=t(3340),C=t(2265),F=t(5060),Z=t(3887),W=t(4400),A=t(158),T=t(9376),z=t(9820);let M=l.Ry({donorName:l.Z_().min(2,{message:"Donor name must be at least 2 characters."}).max(50),email:l.Z_().email({message:"Please enter a valid email address."}),phone:l.Z_().min(8,{message:"Please enter a valid phone number."}).optional().or(l.i0("")),deliveryDate:l.hT({required_error:"Please select a delivery date."}),anonymous:l.O7().default(!1).optional(),howHeard:l.Z_().optional(),consent:l.O7().refine(e=>!0===e,{message:"You must agree to the terms to submit."}),targetSlotId:l.Z_().optional(),mosqueName:l.Z_().optional()});function V(){let{toast:e}=(0,k.pm)(),[a,t]=(0,C.useState)(!1),[l,V]=(0,C.useState)([]),[U,_]=(0,C.useState)(!0),J=(0,T.useRouter)(),O=(0,T.useSearchParams)(),X=(0,C.useRef)(null),[B,Y]=(0,C.useState)(!1);(0,C.useEffect)(()=>{(async()=>{_(!0),V((await (0,A.tN)()).map(e=>e.date)),_(!1)})()},[]);let E=(0,r.cI)({resolver:(0,n.F)(M),defaultValues:{donorName:"",email:"",phone:"",deliveryDate:void 0,anonymous:!1,howHeard:void 0,consent:!1,targetSlotId:void 0,mosqueName:void 0}});(0,C.useEffect)(()=>{let e=O.get("mosqueName"),a=O.get("deliveryDate"),t=O.get("targetSlotId");if(e&&a&&t){E.setValue("mosqueName",e),E.setValue("targetSlotId",t);let s=function(e,a){let t,s;let n=function(e){let a;let t={},s=e.split(g.dateTimeDelimiter);if(s.length>2)return t;if(/:/.test(s[0])?a=s[0]:(t.date=s[0],a=s[1],g.timeZoneDelimiter.test(t.date)&&(t.date=e.split(g.timeZoneDelimiter)[0],a=e.substr(t.date.length,e.length))),a){let e=g.timezone.exec(a);e?(t.time=a.replace(e[1],""),t.timezone=e[1]):t.time=a}return t}(e);if(n.date){let e=function(e,a){let t=RegExp("^(?:(\\d{4}|[+-]\\d{6})|(\\d{2}|[+-]\\d{"+(2+a)+"})$)"),s=e.match(t);if(!s)return{year:NaN,restDateString:""};let n=s[1]?parseInt(s[1]):null,r=s[2]?parseInt(s[2]):null;return{year:null===r?n:100*r,restDateString:e.slice((s[1]||s[2]).length)}}(n.date,2);t=function(e,a){if(null===a)return new Date(NaN);let t=e.match(N);if(!t)return new Date(NaN);let s=!!t[4],n=D(t[1]),r=D(t[2])-1,l=D(t[3]),o=D(t[4]),i=D(t[5])-1;if(s)return o>=1&&o<=53&&i>=0&&i<=6?function(e,a,t){let s=new Date(0);s.setUTCFullYear(e,0,4);let n=s.getUTCDay()||7;return s.setUTCDate(s.getUTCDate()+((a-1)*7+t+1-n)),s}(a,o,i):new Date(NaN);{let e=new Date(0);return r>=0&&r<=11&&l>=1&&l<=(I[r]||(q(a)?29:28))&&n>=1&&n<=(q(a)?366:365)?(e.setUTCFullYear(a,r,Math.max(n,l)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!t||isNaN(t.getTime()))return new Date(NaN);let r=t.getTime(),l=0;if(n.time&&isNaN(l=function(e){let a=e.match(b);if(!a)return NaN;let t=S(a[1]),s=S(a[2]),n=S(a[3]);return(24===t?0===s&&0===n:n>=0&&n<60&&s>=0&&s<60&&t>=0&&t<25)?t*v.vh+s*v.yJ+1e3*n:NaN}(n.time)))return new Date(NaN);if(n.timezone){if(isNaN(s=function(e){if("Z"===e)return 0;let a=e.match(w);if(!a)return 0;let t="+"===a[1]?-1:1,s=parseInt(a[2]),n=a[3]&&parseInt(a[3])||0;return n>=0&&n<=59?t*(s*v.vh+n*v.yJ):NaN}(n.timezone)))return new Date(NaN)}else{let e=new Date(r+l),a=new Date(0);return a.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),a.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),a}return new Date(r+l+s)}(a);E.setValue("deliveryDate",s,{shouldValidate:!0}),Y(!0);let n=new URL(window.location.href);n.searchParams.delete("mosqueName"),n.searchParams.delete("deliveryDate"),n.searchParams.delete("targetSlotId"),J.replace(n.pathname+n.search+window.location.hash,{scroll:!1}),"#sponsor-form-actual"===window.location.hash&&X.current&&X.current.scrollIntoView({behavior:"smooth",block:"start"})}else Y(!1)},[O,E,J]);let H=E.watch("anonymous");async function R(a){if(t(!0),!a.deliveryDate){e({title:"Delivery Date Missing",description:"Please select a delivery date.",variant:"destructive"}),t(!1);return}let s={...a,deliveryDate:(0,P.WU)(a.deliveryDate,"yyyy-MM-dd"),deliveryDisplayDate:(0,P.WU)(a.deliveryDate,"PPP"),quantity:0,pricePerBalang:0,calculatedSubtotal:0,deliveryFee:25,calculatedTotal:25,orderType:"delivery_sponsorship",mosqueName:a.mosqueName,mosqueAddress:void 0},n=await (0,W.K)(s);n.success?(e({title:"Delivery Sponsorship Submitted!",description:"Thank you, ".concat(a.anonymous?"Anonymous Sponsor":a.donorName,"! Your $").concat("25.00"," Jumaat delivery sponsorship for ").concat((0,P.WU)(a.deliveryDate,"PPP")," has been received. This will be assigned to a mosque in need. We will contact you for confirmation. Slot ID: ").concat(n.slotId),variant:"default",duration:1e4}),E.reset({donorName:"",email:"",phone:"",deliveryDate:void 0,anonymous:!1,howHeard:void 0,consent:!1,targetSlotId:void 0,mosqueName:void 0}),Y(!1)):e({title:"Sponsorship Submission Failed",description:n.message||"An unexpected error occurred. Please try again.",variant:"destructive"}),t(!1)}return(0,C.useEffect)(()=>{H?E.setValue("donorName","Anonymous Sponsor"):"Anonymous Sponsor"===E.getValues("donorName")&&E.setValue("donorName","")},[H,E]),(0,s.jsx)(i.l0,{...E,children:(0,s.jsxs)("form",{onSubmit:E.handleSubmit(R),className:"space-y-6",ref:X,id:"sponsor-form-actual",children:[B&&E.getValues("mosqueName")&&E.getValues("deliveryDate")?(0,s.jsxs)(z.Zb,{className:"bg-secondary/30",children:[(0,s.jsxs)(z.Ol,{children:[(0,s.jsx)(z.ll,{className:"text-lg text-green-700",children:"Sponsoring Specific Slot"}),(0,s.jsx)(z.SZ,{children:"You are sponsoring the delivery for the following slot. The details are pre-filled for you."})]}),(0,s.jsxs)(z.aY,{className:"space-y-1 text-sm font-medium",children:[(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Mosque:"})," ",E.getValues("mosqueName")]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"Date:"})," ",(0,P.WU)(E.getValues("deliveryDate"),"PPP")]})]})]}):(0,s.jsx)(i.Wi,{control:E.control,name:"deliveryDate",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-col",children:[(0,s.jsx)(i.lX,{children:"Preferred Delivery Date (Fridays Only) *"}),(0,s.jsxs)(u.J2,{children:[(0,s.jsx)(u.xo,{asChild:!0,children:(0,s.jsx)(i.NI,{children:(0,s.jsxs)(o.z,{variant:"outline",className:(0,x.cn)("w-full pl-3 text-left font-normal",!t.value&&"text-muted-foreground"),disabled:a||U,children:[t.value?(0,P.WU)(t.value,"PPP"):(0,s.jsx)("span",{children:U?"Loading dates...":"Pick a date"}),(0,s.jsx)(p.Z,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),(0,s.jsx)(u.yk,{className:"w-auto p-0",align:"start",children:(0,s.jsx)(m.f,{mode:"single",selected:t.value,onSelect:t.onChange,disabled:[...l,{before:new Date(new Date().setHours(0,0,0,0))},{dayOfWeek:[0,1,2,3,4,6]}],initialFocus:!0})})]}),(0,s.jsx)(i.pf,{children:"Select the Friday you'd like to sponsor the delivery for. The sponsorship will be assigned to a mosque in need on this date."}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:E.control,name:"anonymous",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-row items-center space-x-3 space-y-0 rounded-md border p-4 shadow-sm bg-secondary/20",children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(c.X,{checked:t.value,onCheckedChange:t.onChange,disabled:a,id:"sponsor-anonymous"})}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(i.lX,{htmlFor:"sponsor-anonymous",children:"Sponsor Anonymously"}),(0,s.jsx)(i.pf,{children:"Your name will be recorded as 'Anonymous Sponsor'."})]})]})}}),(0,s.jsx)(i.Wi,{control:E.control,name:"donorName",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Full Name (Sponsor) *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{placeholder:"Your name",...t,disabled:a||H})}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:E.control,name:"email",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Email Address *"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{type:"email",placeholder:"your.email@example.com",...t,disabled:a})}),(0,s.jsx)(i.pf,{children:"For acknowledgment and contact."}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsx)(i.Wi,{control:E.control,name:"phone",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"Your Phone Number (Optional)"}),(0,s.jsx)(i.NI,{children:(0,s.jsx)(d.I,{type:"tel",placeholder:"Your contact number (for WhatsApp)",...t,disabled:a})}),(0,s.jsx)(i.zG,{})]})}}),!B&&(0,s.jsx)(i.Wi,{control:E.control,name:"howHeard",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{children:[(0,s.jsx)(i.lX,{children:"How did you hear about us? (Optional)"}),(0,s.jsxs)(h.Ph,{onValueChange:t.onChange,value:t.value,disabled:a,children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(h.i4,{children:(0,s.jsx)(h.ki,{placeholder:"Please select one"})})}),(0,s.jsx)(h.Bw,{children:Z.q.map(e=>(0,s.jsx)(h.Ql,{value:e,children:e},"sponsor-hear-".concat(e)))})]}),(0,s.jsx)(i.zG,{})]})}}),(0,s.jsxs)("div",{className:"p-4 border rounded-md bg-secondary/30 space-y-1 mt-4",children:[(0,s.jsxs)("div",{className:"flex justify-between text-lg font-bold text-primary items-center",children:[(0,s.jsxs)("span",{className:"flex items-center",children:[(0,s.jsx)(y,{className:"mr-2 h-5 w-5"}),"Sponsorship Amount:"]}),(0,s.jsxs)("span",{children:["$","25.00"]})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"This contribution helps cover the $25 delivery fee for Infaq Balangs to a mosque in need on the selected date."})]}),(0,s.jsx)(i.Wi,{control:E.control,name:"consent",render:e=>{let{field:t}=e;return(0,s.jsxs)(i.xJ,{className:"flex flex-row items-start space-x-3 space-y-0 rounded-md border p-4 shadow-sm",children:[(0,s.jsx)(i.NI,{children:(0,s.jsx)(c.X,{checked:t.value,onCheckedChange:t.onChange,disabled:a,id:"sponsor-consent"})}),(0,s.jsxs)("div",{className:"space-y-1 leading-none",children:[(0,s.jsx)(F._,{htmlFor:"sponsor-consent",className:"cursor-pointer",children:"By submitting this form, I consent to BalangConnect using my personal data for this sponsorship. My data will be handled in compliance with Singapore's PDPA. I acknowledge that BalangConnect may follow up by contacting me via WhatsApp/Email. *"}),(0,s.jsx)(i.zG,{})]})]})}}),(0,s.jsx)(o.z,{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white",disabled:a||!E.formState.isValid,children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(f.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Submitting..."]}):(0,s.jsxs)(s.Fragment,{children:["Sponsor Delivery Fee ",(0,s.jsx)(j.Z,{className:"ml-2 h-4 w-4"})]})})]})})}},3147:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(6471).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},5118:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(6471).Z)("HeartHandshake",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M12 5 9.04 7.96a2.17 2.17 0 0 0 0 3.08c.82.82 2.13.85 3 .07l2.07-1.9a2.82 2.82 0 0 1 3.79 0l2.96 2.66",key:"4oyue0"}],["path",{d:"m18 15-2-2",key:"60u0ii"}],["path",{d:"m15 18-2-2",key:"6p76be"}]])},9342:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(6471).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},9679:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(6471).Z)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]])},2032:function(e,a,t){"use strict";t.d(a,{Z:function(){return s}});let s=(0,t(6471).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])}},function(e){e.O(0,[708,107,878,83,594,9,74,292,585,971,117,744],function(){return e(e.s=3082)}),_N_E=e.O()}]);