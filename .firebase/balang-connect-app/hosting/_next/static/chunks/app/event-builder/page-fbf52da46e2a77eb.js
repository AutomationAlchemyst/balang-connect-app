(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{8520:function(e,s,t){Promise.resolve().then(t.bind(t,6044))},6044:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return ex}});var a=t(7437),l=t(2265),n=t(9376),r=t(8916),i=t(2381),o=t(9820),c=t(5060),d=t(6586),m=t(1593),u=t(5291),x=t(4986),h=t(4233),p=t(6271),f=t(9559),g=t(43),j=t(1520),v=t(5176),N=t(4263),b=t(3459),y=t(4870),w=t(5518),k=t(3340),P=t(9174),C=t(8245),F=t(2749),S=t(9027),z=t(3448);let I=S.fC;S.xz;let A=S.h_;S.x8;let _=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.aV,{ref:s,className:(0,z.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...l})});_.displayName=S.aV.displayName;let E=l.forwardRef((e,s)=>{let{className:t,children:l,...n}=e;return(0,a.jsxs)(A,{children:[(0,a.jsx)(_,{}),(0,a.jsxs)(S.VY,{ref:s,className:(0,z.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[l,(0,a.jsxs)(S.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(x.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});E.displayName=S.VY.displayName;let Z=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,z.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};Z.displayName="DialogHeader";let B=e=>{let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,z.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};B.displayName="DialogFooter";let M=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.Dx,{ref:s,className:(0,z.cn)("text-lg font-semibold leading-none tracking-tight",t),...l})});M.displayName=S.Dx.displayName;let T=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(S.dk,{ref:s,className:(0,z.cn)("text-sm text-muted-foreground",t),...l})});T.displayName=S.dk.displayName;var D=t(3590),O=t(9501),R=t(1229),G=t(670),U=t(279),W=t(3675),Y=t(1230);let J=["Social Media (Facebook, Instagram, etc.)","Google Search","Friend/Family Recommendation","Previous Event Attended","Flyer/Advertisement","Other"],X=["10:00 AM","11:00 AM","12:00 PM","01:00 PM","02:00 PM","03:00 PM","04:00 PM","05:00 PM","06:00 PM","07:00 PM","08:00 PM","09:00 PM","10:00 PM"],q=e=>{let[s,t]=e.split(" "),[a]=s.split(":").map(Number);return 12===a&&(a="AM"===t?0:12),"PM"===t&&a<12&&(a+=12),a},V=R.Ry({fullName:R.Z_().min(2,{message:"Full name must be at least 2 characters."}),email:R.Z_().email({message:"Please enter a valid email address."}),phone:R.Z_().min(8,{message:"Please enter a valid phone number."}),postalCode:R.Z_().min(6,{message:"Postal code must be at least 6 digits."}).max(6,{message:"Postal code must be 6 digits."}),addressBlockHouse:R.Z_().min(1,{message:"Block/House number is required."}),addressUnit:R.Z_().optional(),expectedPax:R.oQ.number().positive({message:"Expected number of pax must be a positive number."}),eventDescription:R.Z_().min(5,{message:"Event description must be at least 5 characters."}),pickupTime:R.Z_().min(1,{message:"Please select a pickup time."}),howHeard:R.Z_().min(1,{message:"Please select an option."})});function Q(e){let{onSubmit:s,onCancel:t,eventTime:n}=e,r=(0,O.cI)({resolver:(0,D.F)(V),defaultValues:{fullName:"",email:"",phone:"",postalCode:"",addressBlockHouse:"",addressUnit:"",expectedPax:"",eventDescription:"",pickupTime:"",howHeard:""}}),{setValue:o,watch:c}=r,d=c("pickupTime"),m=(0,l.useMemo)(()=>{if(!n)return X;let e=q(n)+3;return X.filter(s=>q(s)>=e)},[n]);return(0,l.useEffect)(()=>{d&&!m.includes(d)&&o("pickupTime","",{shouldValidate:!0})},[m,d,o]),(0,a.jsx)(G.l0,{...r,children:(0,a.jsxs)("form",{onSubmit:r.handleSubmit(s),className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"space-y-4 px-6 py-4",children:[(0,a.jsx)(G.Wi,{control:r.control,name:"fullName",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Full Name *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{placeholder:"Your Full Name",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"email",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Email *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{type:"email",placeholder:"your.email@example.com",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"phone",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Phone *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{type:"tel",placeholder:"We will contact you through WhatsApp",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[(0,a.jsx)(G.Wi,{control:r.control,name:"postalCode",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{className:"sm:col-span-1",children:[(0,a.jsx)(G.lX,{children:"Postal Code *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{placeholder:"e.g., 123456",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"addressBlockHouse",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{className:"sm:col-span-2",children:[(0,a.jsx)(G.lX,{children:"Block No / House Number *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{placeholder:"e.g., Blk 123 / 45A Jalan Besar",...s})}),(0,a.jsx)(G.zG,{})]})}})]}),(0,a.jsx)(G.Wi,{control:r.control,name:"addressUnit",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Unit Number (if any)"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{placeholder:"e.g., #01-23",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"expectedPax",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Expected No of Pax *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(U.I,{type:"number",placeholder:"e.g., 50, 100, 200",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"eventDescription",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Tell us a little more about the event *"}),(0,a.jsx)(G.NI,{children:(0,a.jsx)(W.g,{placeholder:"e.g., Wedding, Family Gathering, Birthday, Office Event",className:"resize-y",...s})}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"pickupTime",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"Balang pickup/collection time *"}),(0,a.jsxs)(u.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(G.NI,{children:(0,a.jsx)(u.i4,{children:(0,a.jsx)(u.ki,{placeholder:"Select a pickup time"})})}),(0,a.jsx)(u.Bw,{children:m.length>0?m.map(e=>(0,a.jsx)(u.Ql,{value:e,children:e},e)):(0,a.jsx)(u.Ql,{value:"no-slots",disabled:!0,children:"No available slots (min. 3hr after event)"})})]}),(0,a.jsx)(G.pf,{children:"Time for us to collect empty balangs."}),(0,a.jsx)(G.zG,{})]})}}),(0,a.jsx)(G.Wi,{control:r.control,name:"howHeard",render:e=>{let{field:s}=e;return(0,a.jsxs)(G.xJ,{children:[(0,a.jsx)(G.lX,{children:"How did you hear about us? *"}),(0,a.jsxs)(u.Ph,{onValueChange:s.onChange,value:s.value,children:[(0,a.jsx)(G.NI,{children:(0,a.jsx)(u.i4,{children:(0,a.jsx)(u.ki,{placeholder:"Please select one"})})}),(0,a.jsx)(u.Bw,{children:J.map(e=>(0,a.jsx)(u.Ql,{value:e,children:e},e))})]}),(0,a.jsx)(G.zG,{})]})}})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 p-6 pt-4 border-t shrink-0",children:[(0,a.jsx)(i.z,{type:"button",variant:"outline",onClick:t,children:"Cancel"}),(0,a.jsxs)(i.z,{type:"submit",className:"bg-primary hover:bg-primary/90 text-primary-foreground",children:["Proceed to Payment ",(0,a.jsx)(Y.Z,{className:"ml-2 h-4 w-4"})]})]})]})})}var $=t(3145),H=t(7168),L=t(2478),K=t(5361),ee=t(659),es=t(3697),et=t(5255),ea=t(3390),el=t(7648);let en="UEN53482512EA00#XNAP",er="8852-1535-4360";function ei(e){let{isOpen:s,onClose:t,totalAmount:n,eventDate:r,eventTime:o,customerName:d,customerEmail:m,onSubmitProof:u}=e,[x,h]=(0,l.useState)(null),[p,f]=(0,l.useState)(!1),[g,j]=(0,l.useState)("idle"),[v,N]=(0,l.useState)("idle"),[y,w]=(0,l.useState)(null),[P,F]=(0,l.useState)(null),[S,A]=(0,l.useState)(null),{toast:_}=(0,k.pm)(),D=()=>{h(null),f(!1),j("idle"),F(null),A(null),N("idle"),w(null)},O=e=>{"submitting"===v||e||(D(),t())},R=e=>{var s;let t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!t)return;if(h(null),F(null),A(t.name),j("reading"),!["image/jpeg","image/png","image/gif","application/pdf"].includes(t.type)){F("Invalid file type. Please use JPG, PNG, GIF or PDF."),j("error");return}if(t.size>5242880){F("File is too large. Max size is 5MB."),j("error");return}let a=new FileReader;a.onload=e=>{var s;h({file:t,dataUri:null===(s=e.target)||void 0===s?void 0:s.result}),j("success")},a.onerror=()=>{var e;console.error("FileReader error:",a.error);let s=(null===(e=a.error)||void 0===e?void 0:e.message)||"Unknown permission issue.";F("Could not read file: ".concat(s)),j("error"),h(null)},a.readAsDataURL(t)},G=async()=>{if(!p){_({title:"Consent Required",description:"Please agree to the terms and conditions.",variant:"destructive"});return}if(!x||"success"!==g){_({title:"Payment Proof Required",description:"Please upload a valid screenshot or PDF of your payment proof.",variant:"destructive"});return}N("submitting"),w(null);let e=await u({proofDataUri:x.dataUri,proofFile:x.file,consentedToTerms:p});e.success?N("success"):(w(e.error||"An unexpected error occurred."),N("error"))},W=(e,s)=>{navigator.clipboard.writeText(e).then(()=>{_({title:"".concat(s," Copied!"),description:"".concat(e," has been copied to your clipboard.")})}).catch(e=>{_({title:"Copy Failed",description:"Could not copy ".concat(s,". Please copy manually."),variant:"destructive"}),console.error("Failed to copy: ",e)})},Y="reading"===g||"submitting"===v;return(0,a.jsx)(I,{open:s,onOpenChange:O,children:(0,a.jsxs)(E,{className:"sm:max-w-lg md:max-w-xl lg:max-w-2xl flex flex-col max-h-[90vh] overflow-hidden",children:[(0,a.jsxs)(Z,{className:"p-6 pb-4 border-b shrink-0",children:[(0,a.jsxs)(M,{className:"font-headline text-primary flex items-center",children:[(0,a.jsx)(ea.Z,{className:"mr-2 h-6 w-6"})," Payment & Order Confirmation"]}),(0,a.jsx)(T,{children:"Review your order, make payment, and upload proof to finalize your booking."})]}),(()=>{switch(v){case"submitting":return(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full p-10",children:[(0,a.jsx)(b.Z,{className:"w-16 h-16 text-primary animate-spin"}),(0,a.jsx)("p",{className:"mt-4 text-lg text-muted-foreground",children:"Submitting Your Booking..."})]});case"success":let e=encodeURIComponent("".concat("Hello BalangConnect, I have just made a booking.","\n\nName: ").concat(d,"\nEvent: ").concat(r," at ").concat(o,"\nEmail: ").concat(m)),s="https://wa.me/".concat("6583215730","?text=").concat(e);return(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)(L.Z,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold font-headline text-primary",children:"Booking Request Sent!"}),(0,a.jsxs)("p",{className:"mt-2 text-muted-foreground",children:["Thank you, ",d,"! We've received your booking request. We will verify your payment and confirm via WhatsApp/Email within 1 business day."]}),(0,a.jsxs)("div",{className:"mt-6 p-4 border rounded-lg bg-secondary/30 text-left text-sm",children:[(0,a.jsx)("h3",{className:"font-semibold mb-2",children:"Your Booking Summary:"}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Event:"})," ",r," at ",o]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Amount:"})," $",n.toFixed(2)]}),(0,a.jsxs)("p",{children:[(0,a.jsx)("strong",{children:"Contact:"})," ",m]})]}),(0,a.jsx)(i.z,{asChild:!0,size:"lg",className:"w-full mt-6 bg-green-600 hover:bg-green-700 text-white",children:(0,a.jsxs)(el.default,{href:s,target:"_blank",rel:"noopener noreferrer",children:[(0,a.jsxs)("svg",{role:"img",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",className:"mr-2 h-5 w-5",children:[(0,a.jsx)("title",{children:"WhatsApp"}),(0,a.jsx)("path",{d:"M17.472 14.382c-.297-.149-.88-.436-1.017-.486-.137-.05-.282-.075-.427.075-.145.149-.391.486-.479.562-.088.075-.176.088-.32.013-.145-.075-.612-.224-1.168-.722-.431-.397-.71-.88-.798-1.03-.088-.149-.013-.224.062-.299.063-.063.145-.164.218-.239.063-.062.088-.124.126-.21.037-.087.012-.162-.013-.238-.025-.075-.427-1.017-.584-1.396-.145-.353-.297-.303-.427-.303-.125-.013-.269-.013-.391-.013a.75.75 0 0 0-.529.238c-.19.19-.693.675-.693 1.65a.75.75 0 0 0 .126 1.017c.088.163.693.983 1.693 1.65.983.675 1.763.88 2.12.983.612.162.983.137 1.372.087.436-.05.88-.187 1.004-.362.125-.175.125-.337.088-.387s-.163-.187-.225-.212zM12 2a10 10 0 1 0 10 10 10 10 0 0 0-10-10z"})]}),"Contact us on WhatsApp"]})}),(0,a.jsx)(B,{className:"mt-4 !justify-center",children:(0,a.jsx)(i.z,{variant:"outline",onClick:()=>O(!1),children:"Make Another Booking"})})]});case"error":return(0,a.jsxs)("div",{className:"p-6 text-center",children:[(0,a.jsx)(K.Z,{className:"w-16 h-16 text-destructive mx-auto mb-4"}),(0,a.jsx)("h2",{className:"text-2xl font-bold font-headline text-destructive",children:"Submission Failed"}),(0,a.jsx)("p",{className:"mt-2 text-muted-foreground",children:"We couldn't finalize your booking. Please see the error below."}),(0,a.jsx)("div",{className:"mt-4 p-3 border rounded-md bg-destructive/10 text-destructive text-sm text-left",children:(0,a.jsx)("p",{children:y})}),(0,a.jsxs)(B,{className:"mt-6",children:[(0,a.jsx)(i.z,{variant:"outline",onClick:()=>O(!1),children:"Cancel"}),(0,a.jsx)(i.z,{onClick:()=>N("idle"),children:"Try Again"})]})]});default:return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex-grow min-h-0 overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"p-4 border rounded-lg bg-secondary/30",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-2 text-primary",children:"Order Summary"}),r&&o&&(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Event:"})," ",r," at ",o]}),(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("strong",{children:"Total Amount Due:"})," ",(0,a.jsxs)("span",{className:"font-bold text-accent text-xl",children:["$",n.toFixed(2)]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-md font-semibold mb-2 text-foreground",children:"Payment Instructions:"}),(0,a.jsxs)(H.mQ,{defaultValue:"paynow_qr",className:"w-full",children:[(0,a.jsxs)(H.dr,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(H.SP,{value:"paynow_qr",children:"PayNow QR"}),(0,a.jsx)(H.SP,{value:"paynow_uen",children:"PayNow UEN"}),(0,a.jsx)(H.SP,{value:"fast_transfer",children:"FAST Transfer"})]}),(0,a.jsxs)(H.nU,{value:"paynow_qr",className:"mt-4 p-4 border rounded-md",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Scan the QR code below using your banking app."}),(0,a.jsx)($.default,{src:"https://placehold.co/250x250.png?text=PayNow+QR+Code",alt:"PayNow QR Code",width:250,height:250,className:"mx-auto rounded-md shadow-md","data-ai-hint":"QR code"})]}),(0,a.jsxs)(H.nU,{value:"paynow_uen",className:"mt-4 p-4 border rounded-md space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"PayNow to UEN (Unique Entity Number):"}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[(0,a.jsx)("span",{className:"font-mono text-sm",children:en}),(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>W(en,"UEN"),children:[(0,a.jsx)(ee.Z,{className:"mr-1 h-4 w-4"})," Copy"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:'Ensure the recipient name matches "BalangConnect" (or your registered business name).'})]}),(0,a.jsxs)(H.nU,{value:"fast_transfer",className:"mt-4 p-4 border rounded-md space-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"FAST Transfer to DBS Bank Ltd:"}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-muted rounded-md",children:[(0,a.jsx)("span",{className:"font-mono text-sm",children:er}),(0,a.jsxs)(i.z,{variant:"ghost",size:"sm",onClick:()=>W(er,"Account No."),children:[(0,a.jsx)(ee.Z,{className:"mr-1 h-4 w-4"})," Copy"]})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Account Name: BalangConnect (or your registered business name). Please include your name or phone number in the transfer reference/comments."})]})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(c._,{htmlFor:"paymentProof",className:"text-md font-semibold text-foreground",children:"Upload Payment Proof*"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"After payment, please upload a screenshot or PDF of your transaction confirmation. Max file size: 5MB."}),(0,a.jsx)("div",{className:"flex items-center justify-center w-full",children:(0,a.jsxs)("label",{htmlFor:"paymentProof",className:(0,z.cn)("flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-lg cursor-pointer bg-card hover:bg-muted transition-colors","error"===g&&"border-destructive","success"===g&&"border-green-500"),children:[(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center pt-5 pb-6 text-center",children:["idle"===g&&(0,a.jsx)(es.Z,{className:"w-8 h-8 mb-2 text-muted-foreground"}),"reading"===g&&(0,a.jsx)(b.Z,{className:"w-8 h-8 mb-2 text-muted-foreground animate-spin"}),"success"===g&&(0,a.jsx)(et.Z,{className:"w-8 h-8 mb-2 text-green-500"}),"error"===g&&(0,a.jsx)(K.Z,{className:"w-8 h-8 mb-2 text-destructive"}),(0,a.jsx)("p",{className:"mb-1 text-sm text-muted-foreground",children:(0,a.jsxs)("span",{className:"font-semibold",children:["idle"===g&&"Click to upload or drag and drop","reading"===g&&"Reading file...","success"===g&&(S||"File uploaded successfully!"),"error"===g&&(S||"An error occurred")]})}),"error"===g&&(0,a.jsx)("p",{className:"text-xs text-destructive",children:P}),"error"!==g&&(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG, GIF, PDF (MAX. 5MB)"})]}),(0,a.jsx)(U.I,{id:"paymentProof",type:"file",className:"hidden",onChange:R,accept:"image/*,.pdf",disabled:Y})]})})]}),(0,a.jsxs)("div",{className:"items-top flex space-x-2 pt-2",children:[(0,a.jsx)(C.X,{id:"termsPayment",checked:p,onCheckedChange:e=>f(!!e),disabled:Y}),(0,a.jsxs)("div",{className:"grid gap-1.5 leading-none",children:[(0,a.jsx)("label",{htmlFor:"termsPayment",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Agree to Terms and Conditions*"}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"By submitting, I confirm payment has been made. I consent to BalangConnect processing my personal data for this booking in compliance with Singapore's PDPA. I acknowledge that BalangConnect will follow up via WhatsApp/Email."})]})]})]})}),(0,a.jsxs)(B,{className:"p-6 pt-4 border-t shrink-0",children:[(0,a.jsx)(i.z,{variant:"outline",onClick:()=>O(!1),disabled:Y,children:"Cancel"}),(0,a.jsx)(i.z,{onClick:G,className:"bg-accent hover:bg-accent/90 text-accent-foreground",disabled:Y||"success"!==g||!p,children:"Confirm Booking & Submit Proof"})]})]})}})()]})})}var eo=t(6291),ec=t(7107);t(3079);var ed=(0,t(2119).$)("5a48bb1915cf3378b373d92b4ee21ad4dd83bf69"),em=t(158);let eu=["09:00 AM","10:00 AM","11:00 AM","12:00 PM","01:00 PM","02:00 PM","03:00 PM","04:00 PM","05:00 PM"];function ex(){let e=(0,n.useSearchParams)(),s=(0,n.useRouter)(),{toast:t}=(0,k.pm)(),[S,A]=(0,l.useState)(null),[_,D]=(0,l.useState)([]),[O,R]=(0,l.useState)({}),[G,U]=(0,l.useState)({}),[W,Y]=(0,l.useState)(0),[J,X]=(0,l.useState)(0),[q,V]=(0,l.useState)(null),[$,H]=(0,l.useState)(!1),[L,K]=(0,l.useState)(void 0),[ee,es]=(0,l.useState)(void 0),[et,ea]=(0,l.useState)(!1),[el,en]=(0,l.useState)(null),[er,ex]=(0,l.useState)(null),[eh,ep]=(0,l.useState)(!1),[ef,eg]=(0,l.useState)([]),[ej,ev]=(0,l.useState)(!0);(0,l.useEffect)(()=>{(async()=>{ev(!0);try{let e=await (0,em.tN)();eg(e.map(e=>e.date))}catch(e){console.error("Failed to fetch blocked dates for event builder:",e),t({title:"Could not load calendar",description:"Failed to fetch blocked dates. Please try refreshing.",variant:"destructive"})}finally{ev(!1)}})()},[t]);let eN=(0,l.useCallback)(()=>{if(S){let e=S.includedItems.find(e=>/choice of (\d+) flavor/i.test(e.toLowerCase()));if(e){let s=e.match(/choice of (\d+) flavor/i);if(s&&s[1])return parseInt(s[1],10)}let s=S.includedItems.find(e=>e.toLowerCase().includes("balang"));if(s){let e=s.match(/(\d+)\s*x\s*\d+L\s*Balang/i);if(e&&e[1])return parseInt(e[1],10)}}return 0},[S]),eb=(0,l.useCallback)(e=>{D(s=>{let a=eN();if(s.length<a)return[...s,e];{let l=d.sG.find(s=>s.id===e);return setTimeout(()=>{t({title:"Package Flavor Limit Reached",description:"Cannot add '".concat((null==l?void 0:l.name)||"Unknown Flavor","'. Your selected package allows a maximum of ").concat(a," flavors."),variant:"destructive"})},0),s}})},[eN,t]),ey=e=>{D(s=>s.filter((s,t)=>t!==e))};(0,l.useEffect)(()=>{D([])},[S]),(0,l.useEffect)(()=>{let t=e.get("defaultPackageId");if(t){let a=d.xF.find(e=>e.id===t);a&&(null==S?void 0:S.id)!==a.id&&A(a);let l=new URLSearchParams(Array.from(e.entries()));if(l.has("defaultPackageId")){l.delete("defaultPackageId");let e=l.toString();s.replace("/event-builder".concat(e?"?".concat(e):""),{scroll:!1})}}},[e,s,null==S?void 0:S.id]),(0,l.useEffect)(()=>{let a=e.get("addFlavorIds"),l=new URLSearchParams(Array.from(e.entries()));if(a&&S){let e=a.split(","),n=eN(),r=[];if(D(s=>{let t=[...s];for(let s of e)if(t.length<n)t.includes(s),t.push(s);else{let e=d.sG.find(e=>e.id===s);r.push((null==e?void 0:e.name)||s)}return t.slice(0,n)}),r.length>0&&setTimeout(()=>{t({title:"Package Flavor Limit Reached",description:"Could not add: ".concat(r.join(", "),". '").concat(S.name,"' allows ").concat(n," flavor(s). Others were added if space allowed."),variant:"destructive"})},0),l.has("addFlavorIds")){l.delete("addFlavorIds");let e=l.toString();s.replace("/event-builder".concat(e?"?".concat(e):""),{scroll:!1})}}else if(a&&!S&&!l.has("defaultPackageId")&&(setTimeout(()=>{t({title:"Select a Package",description:"Please select a base package to add these flavors.",variant:"default"})},0),l.has("addFlavorIds"))){l.delete("addFlavorIds");let e=l.toString();s.replace("/event-builder".concat(e?"?".concat(e):""),{scroll:!1})}},[e,s,S,eN,t]),(0,l.useEffect)(()=>{let e=0,s=!1;S&&(e+=S.price);let t=Object.entries(O).filter(e=>{let[,s]=e;return s>0});t.length>0&&t.forEach(s=>{let[t,a]=s,l=d.tX.find(e=>e.id===t);l&&(e+=l.price*a)}),t.length>0&&(!S||S&&!S.isAllInclusive)?(e+=45,s=!0):S&&!S.isAllInclusive&&(e+=45,s=!0),Y(e),X(s?45:0)},[S,O]),(0,l.useEffect)(()=>{U(e=>{let s={},t=!1,a=["addon_balang_23l","addon_balang_40l"];for(let l in O)if(a.includes(l)){let a=O[l],n=e[l]||[],r=Array(a).fill(void 0).map((e,s)=>n[s]);JSON.stringify(e[l])!==JSON.stringify(r)&&(t=!0),s[l]=r}for(let s in e){var l;a.includes(s)&&(!O[s]||0===O[s])?t=!0:a.includes(s)&&O[s]&&(null===(l=e[s])||void 0===l?void 0:l.length)!==O[s]&&(t=!0)}if(!t){let t=Object.keys(e).filter(e=>a.includes(e)).length===Object.keys(s).filter(e=>a.includes(e)).length;if(t){for(let l in s)if(a.includes(l)&&(!e[l]||JSON.stringify(e[l])!==JSON.stringify(s[l]))){t=!1;break}if(t&&Object.keys(e).filter(e=>a.includes(e)).every(e=>s.hasOwnProperty(e)))return e}}let n={...e};return a.forEach(e=>{s[e]?n[e]=s[e]:0!==O[e]&&O[e]||delete n[e]}),n})},[O]);let ew=(e,s)=>{R(t=>{let a={...t};return s?a[e]=1:(delete a[e],("addon_balang_23l"===e||"addon_balang_40l"===e)&&U(s=>{let{[e]:t,...a}=s;return a})),a})},ek=(e,s)=>{R(t=>{let a=(t[e]||0)+s;if(a<=0){let{[e]:s,...a}=t;return("addon_balang_23l"===e||"addon_balang_40l"===e)&&U(s=>{let{[e]:t,...a}=s;return a}),a}return{...t,[e]:a}})},eP=(e,s,t)=>{U(a=>{let l=[...a[e]||[]];for(;l.length<=s;)l.push(void 0);return l[s]=t,{...a,[e]:l}})},eC=(e,s)=>{U(t=>{let a=[...t[e]||[]];return s<a.length&&(a[s]=void 0),{...t,[e]:a}})},eF=async e=>{if(!el||!er||!L||!ee){let e="Critical booking information is missing. Please restart the process.";return t({title:"Error",description:e,variant:"destructive"}),{success:!1,error:e}}if(!e.consentedToTerms)return{success:!1,error:"You must agree to the terms and conditions to complete your booking."};try{var s,a,l,n,r;let t=el.addons.map(e=>({name:e.name,quantity:e.quantity,flavors:e.flavors||[]})),i={type:"Event",customerName:er.fullName,email:er.email,phone:er.phone,eventDate:(0,ec.WU)(L,"yyyy-MM-dd"),eventTime:el.eventTime,totalAmount:el.totalPrice,pickupTime:er.pickupTime,packageName:null===(s=el.selectedPackage)||void 0===s?void 0:s.name,packageFlavors:null===(a=el.selectedPackage)||void 0===a?void 0:a.flavors,addons:t,paymentProofDataUri:e.proofDataUri,paymentProofFileName:e.proofFile.name,paymentProofFileType:e.proofFile.type},o=await ed(i);if(!(null===(l=o.sheet)||void 0===l?void 0:l.success)||!(null===(n=o.calendar)||void 0===n?void 0:n.success)||!(null===(r=o.drive)||void 0===r?void 0:r.success)){let e=[o.sheet.error,o.calendar.error,o.drive.error].filter(Boolean).join(", ");return console.error("Google Sync Failed. Details:",e),{success:!1,error:"Your booking was received, but there was an issue syncing with our backend systems. Please contact us to confirm. Details: ".concat(e)}}return{success:!0}}catch(e){return console.error("Failed to call createBookingFlow:",e),{success:!1,error:e.message||"An unexpected error occurred while finalizing the booking."}}},eS=!!S,ez=eS?eN():0,eI=!1;eS&&(eI=!(ez>0)||_.length===ez);let eA=Object.keys(O).some(e=>O[e]>0),e_=eI||!eS&&eA;return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsx)(r.Z,{children:"Build Your Custom Event Package"}),(0,a.jsx)("p",{className:"text-lg text-center text-muted-foreground mb-12 max-w-2xl mx-auto",children:"Create your perfect event! Choose from our tasty balang drinks and fun add-ons. Pick a base package or build your own from scratch."}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2 space-y-6",children:[(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{className:"font-headline text-primary",children:"1. Base Package"}),(0,a.jsx)(o.SZ,{children:"Select a pre-defined package or choose 'None' to build from scratch. Note: A delivery fee applies if you only select add-ons without an all-inclusive base package."})]}),(0,a.jsxs)(o.aY,{children:[(0,a.jsxs)(u.Ph,{onValueChange:e=>{"none-option"===e?A(null):A(d.xF.find(s=>s.id===e)||null)},value:(null==S?void 0:S.id)||"none-option",children:[(0,a.jsx)(u.i4,{className:"w-full",children:(0,a.jsx)(u.ki,{placeholder:"Select a package..."})}),(0,a.jsxs)(u.Bw,{children:[(0,a.jsx)(u.Ql,{value:"none-option",children:"None (Build from scratch)"}),d.xF.map(e=>(0,a.jsxs)(u.Ql,{value:e.id,children:[e.name," ($",e.price.toFixed(2),")"]},e.id))]})]}),S&&(0,a.jsxs)("div",{className:"mt-4 p-4 bg-secondary/30 rounded-md",children:[(0,a.jsx)("h4",{className:"font-semibold",children:S.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:S.description}),S.isAllInclusive&&(0,a.jsxs)("p",{className:"text-xs mt-1 text-muted-foreground",children:["Note: Price is all-inclusive of setup (worth $",S.setupFee.toFixed(2),"), delivery (worth $","45.00",") & cups."]}),(0,a.jsx)("ul",{className:"text-xs mt-2",children:S.includedItems.map(e=>(0,a.jsxs)("li",{children:["- ",e]},e))})]})]})]}),S&&ez>0&&(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{className:"font-headline text-primary",children:"2. Choose Your Package Flavors"}),(0,a.jsxs)(o.SZ,{children:["Select up to ",ez," flavors for your chosen package. You can pick the same flavor multiple times if desired. You have selected ",_.length," / ",ez," flavors.",ez>0&&_.length<ez&&(0,a.jsxs)("span",{className:"block mt-1 text-destructive text-xs font-semibold",children:["Please select all ",ez," flavors for this package to proceed. You have currently selected ",_.length,"."]})]})]}),(0,a.jsxs)(o.aY,{className:"space-y-4",children:[_.length>0&&(0,a.jsxs)("div",{className:"mb-4 space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-sm text-muted-foreground",children:"Your Selections:"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:_.map((e,s)=>{let t=d.sG.find(s=>s.id===e);return(0,a.jsxs)(P.C,{variant:"secondary",className:"text-sm pl-3 pr-1 py-1",children:[(null==t?void 0:t.name)||"Unknown Flavor",(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"ml-1 h-4 w-4 hover:bg-destructive/20",onClick:()=>ey(s),"aria-label":"Remove ".concat((null==t?void 0:t.name)||"flavor"," at position ").concat(s+1),children:(0,a.jsx)(x.Z,{size:12})})]},"selected-pkgflavor-".concat(e,"-").concat(s))})})]}),_.length>0&&(0,a.jsx)(m.Separator,{className:"my-3"}),(0,a.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3",children:d.sG.map(e=>{let s=_.filter(s=>s===e.id).length,t=_.length<ez;return(0,a.jsxs)("div",{className:"p-3 border rounded-md flex flex-col justify-between gap-2 hover:bg-secondary/20 transition-colors",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(c._,{className:"font-medium text-xs",children:e.name}),s>0&&(0,a.jsxs)("span",{className:"ml-2 text-xs text-muted-foreground",children:["(Selected x",s,")"]})]}),(0,a.jsxs)(i.z,{size:"sm",variant:"outline",className:"w-full",onClick:()=>eb(e.id),disabled:!t||!S,"aria-label":"Add ".concat(e.name," to package"),children:[(0,a.jsx)(h.Z,{size:14,className:"mr-1.5"})," Add Flavor"]})]},"avail-pkgflavor-".concat(e.id))})})]})]}),(0,a.jsxs)(o.Zb,{children:[(0,a.jsxs)(o.Ol,{children:[(0,a.jsx)(o.ll,{className:"font-headline text-primary",children:"3. Select Add-ons"}),(0,a.jsx)(o.SZ,{children:"Enhance your event with these optional extras."})]}),(0,a.jsx)(o.aY,{className:"space-y-4",children:d.tX.map(e=>(0,a.jsxs)("div",{className:"p-3 border rounded-md hover:bg-secondary/20 transition-colors",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(c._,{htmlFor:"addon-".concat(e.id),className:"flex-grow cursor-pointer pr-4",children:[(0,a.jsx)("span",{className:"font-medium block",children:e.name}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.description," (+$",e.price.toFixed(2),")"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[O[e.id]>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>ek(e.id,-1),className:"h-7 w-7","aria-label":"Decrease quantity of ".concat(e.name),children:(0,a.jsx)(p.Z,{size:16})}),(0,a.jsx)("span",{className:"w-6 text-center tabular-nums",children:O[e.id]}),(0,a.jsx)(i.z,{variant:"ghost",size:"icon",onClick:()=>ek(e.id,1),className:"h-7 w-7","aria-label":"Increase quantity of ".concat(e.name),children:(0,a.jsx)(h.Z,{size:16})})]}),(0,a.jsx)(C.X,{id:"addon-".concat(e.id),checked:!!O[e.id]&&O[e.id]>0,onCheckedChange:s=>ew(e.id,!!s),"aria-label":"Select ".concat(e.name)})]})]}),("addon_balang_23l"===e.id||"addon_balang_40l"===e.id)&&O[e.id]>0&&(0,a.jsxs)("div",{className:"pl-0 mt-3 pt-3 border-t border-muted space-y-3",children:[(0,a.jsxs)("h4",{className:"text-sm font-medium text-muted-foreground",children:["Choose flavors for your ",e.name.toLowerCase(),":"]}),[...Array(O[e.id])].map((s,t)=>{var l;let n=null===(l=G[e.id])||void 0===l?void 0:l[t],r=n?d.sG.find(e=>e.id===n):null;return(0,a.jsxs)("div",{className:"mt-2 p-3 border rounded-md space-y-2 bg-background/50",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(c._,{className:"text-sm",children:["Flavor for ",e.name.replace("Additional 1 x ","")," #",t+1,":"]}),r?(0,a.jsxs)(P.C,{variant:"secondary",className:"text-sm pl-2 pr-1 py-0.5",children:[r.name,(0,a.jsx)(i.z,{variant:"ghost",size:"icon",className:"ml-1 h-4 w-4 hover:bg-destructive/20 text-muted-foreground hover:text-destructive-foreground",onClick:()=>eC(e.id,t),"aria-label":"Remove ".concat(r.name," from ").concat(e.name.replace("Additional 1 x ","")," #").concat(t+1),children:(0,a.jsx)(x.Z,{size:12})})]}):(0,a.jsx)("p",{className:"text-xs text-muted-foreground italic",children:"No flavor selected"})]}),(0,a.jsxs)(F.J2,{open:(null==q?void 0:q.addonId)===e.id&&(null==q?void 0:q.balangIndex)===t,onOpenChange:s=>{s?V({addonId:e.id,balangIndex:t}):V(null)},children:[(0,a.jsx)(F.xo,{asChild:!0,children:(0,a.jsx)(i.z,{variant:"outline",size:"sm",className:"w-full text-xs",children:n?"Change Flavor":"Select Flavor"})}),(0,a.jsx)(F.yk,{className:"w-[280px] p-0",side:"bottom",align:"start",children:(0,a.jsxs)("div",{className:"p-2",children:[(0,a.jsx)("h4",{className:"text-xs font-medium mb-2 text-muted-foreground px-1",children:"Available Flavors"}),(0,a.jsx)("div",{className:"max-h-48 overflow-y-auto space-y-1",children:d.sG.map(s=>(0,a.jsxs)(i.z,{variant:n===s.id?"default":"ghost",size:"sm",className:"w-full justify-start text-left h-auto py-1.5 text-xs",onClick:()=>{eP(e.id,t,s.id),V(null)},children:[n===s.id&&(0,a.jsx)(f.Z,{className:"mr-2 h-3 w-3"}),s.name]},"".concat(e.id,"-balang-").concat(t,"-popoverflavor-").concat(s.id)))})]})})]})]},"".concat(e.id,"-balang-").concat(t))})]})]},e.id))})]})]}),(0,a.jsx)("div",{className:"lg:col-span-1 space-y-6",children:(0,a.jsxs)(o.Zb,{className:"sticky top-24 shadow-xl",children:[(0,a.jsx)(o.Ol,{children:(0,a.jsxs)(o.ll,{className:"font-headline text-accent flex items-center",children:[(0,a.jsx)(g.Z,{className:"mr-2"}),"Your Event Summary"]})}),(0,a.jsxs)(o.aY,{className:"space-y-3",children:[S&&(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsxs)("h4",{className:"font-semibold flex items-center",children:[(0,a.jsx)(j.Z,{size:16,className:"mr-2 text-primary"}),S.name]}),(0,a.jsxs)("div",{className:"pl-6",children:[(0,a.jsxs)("p",{children:["Package Price: $",S.price.toFixed(2)]}),S.isAllInclusive&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground ml-0",children:["(Includes setup worth $",S.setupFee.toFixed(2),", delivery worth $","45.00",", and unlimited cups)"]})]})]}),J>0&&(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)(m.Separator,{className:"my-2"}),(0,a.jsxs)("h4",{className:"font-semibold flex items-center",children:[(0,a.jsx)(v.Z,{size:16,className:"mr-2 text-primary"}),"Delivery & Pickup"]}),(0,a.jsx)("div",{className:"pl-6",children:(0,a.jsxs)("p",{children:["$","45.00"," ",(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"(Applied for add-ons without an inclusive base package or non all-inclusive packages)"})]})})]}),_.length>0&&S&&ez>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(m.Separator,{className:"my-2"}),(0,a.jsxs)("h4",{className:"font-semibold",children:["Selected Package Flavors (",_.length,"/",ez,"):"]}),(0,a.jsx)("ul",{className:"list-disc list-inside text-sm pl-6",children:(()=>{let e={};return _.forEach(s=>{e[s]=(e[s]||0)+1}),Object.entries(e).map(e=>{let[s,t]=e,l=d.sG.find(e=>e.id===s);return(0,a.jsxs)("li",{children:[(null==l?void 0:l.name)||"Unknown Flavor"," ",t>1?"(x".concat(t,")"):""]},"pkgsummary-".concat(s))})})()})]}),Object.keys(O).filter(e=>O[e]>0).length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)(m.Separator,{className:"my-2"}),(0,a.jsxs)("h4",{className:"font-semibold flex items-center",children:[(0,a.jsx)(N.Z,{size:16,className:"mr-2 text-primary"}),"Add-ons:"]}),(0,a.jsx)("div",{className:"pl-6 space-y-1 mt-1",children:Object.entries(O).map(e=>{var s;let[t,l]=e;if(0===l)return null;let n=d.tX.find(e=>e.id===t);if(!n)return null;let r="addon_balang_23l"===n.id||"addon_balang_40l"===n.id,i=null===(s=G[t])||void 0===s?void 0:s.map(e=>{var s;return e?null===(s=d.sG.find(s=>s.id===e))||void 0===s?void 0:s.name:void 0});return(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsxs)("span",{children:[n.name," (x",l,")"]}),(0,a.jsxs)("span",{children:["$",(n.price*l).toFixed(2)]})]}),r&&i&&i.some(e=>e)&&(0,a.jsx)("ul",{className:"list-disc list-inside text-xs pl-4 text-muted-foreground",children:i.map((e,s)=>e?(0,a.jsxs)("li",{children:[e," (Balang #",s+1,")"]},"".concat(t,"-summaryflavor-").concat(s)):null)})]},t)})})]}),(0,a.jsx)(m.Separator,{}),(0,a.jsxs)("div",{className:"flex justify-between items-center text-2xl font-bold",children:[(0,a.jsx)("span",{className:"font-headline text-primary",children:"Total:"}),(0,a.jsxs)("span",{className:"text-accent",children:["$",W.toFixed(2)]})]})]}),(0,a.jsx)(o.eW,{children:(0,a.jsx)(i.z,{size:"lg",className:"w-full bg-accent hover:bg-accent/90 text-accent-foreground",onClick:()=>{if(!S&&0===Object.keys(O).filter(e=>O[e]>0).length){t({title:"Empty Configuration",description:"Please select a package or at least one add-on to proceed.",variant:"destructive"});return}let e=S?eN():0;if(S&&e>0&&_.length<e){t({title:"Package Flavors Incomplete",description:"Please select all ".concat(e," flavors for the '").concat(S.name,"'. You have currently selected ").concat(_.length,"."),variant:"destructive"});return}let s=_.map(e=>{var s;return null===(s=d.sG.find(s=>s.id===e))||void 0===s?void 0:s.name}).filter(e=>!!e),a=Object.entries(O).map(e=>{let[s,t]=e;if(0===t)return null;let a=d.tX.find(e=>e.id===s);if(!a)return null;let l=(G[s]||[]).map(e=>{var s;return e?null===(s=d.sG.find(s=>s.id===e))||void 0===s?void 0:s.name:void 0}).filter(e=>!!e);return{name:a.name,quantity:t,price:(a.price*t).toFixed(2),...l.length>0&&{flavors:l}}}).filter(e=>null!==e);en({selectedPackage:S?{name:S.name,price:S.price.toFixed(2),...s.length>0&&{flavors:s}}:null,addons:a.length>0?a:[],deliveryFee:J,totalPrice:W}),H(!0)},disabled:!e_||ej,children:ej?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{className:"mr-2 h-4 w-4 animate-spin"})," Loading Dates..."]}):(0,a.jsxs)(a.Fragment,{children:["Proceed to Book ",(0,a.jsx)(y.Z,{className:"ml-2"})]})})})]})})]}),(0,a.jsx)(I,{open:$,onOpenChange:H,children:(0,a.jsxs)(E,{className:"sm:max-w-md md:max-w-lg",children:[(0,a.jsxs)(Z,{className:"p-6 pb-4 border-b",children:[(0,a.jsxs)(M,{className:"font-headline text-primary flex items-center",children:[(0,a.jsx)(w.Z,{className:"mr-2 h-6 w-6"})," Select Event Date & Time"]}),(0,a.jsx)(T,{children:"Choose your desired date and time for the event. Blocked dates are disabled."})]}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[auto_minmax(0,1fr)] gap-4 items-start",children:[(0,a.jsx)("div",{children:(0,a.jsx)(eo.f,{mode:"single",selected:L,onSelect:K,disabled:[...ef,{before:new Date(new Date().setHours(0,0,0,0))}],className:"rounded-md border shadow-sm"})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(c._,{className:"font-medium text-sm",children:"Available Time Slots:"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2 max-h-[260px] overflow-y-auto pr-1",children:eu.map(e=>(0,a.jsx)(i.z,{variant:ee===e?"default":"outline",size:"sm",onClick:()=>es(e),className:(0,z.cn)("w-full justify-center text-xs",ee===e&&"bg-primary text-primary-foreground"),children:e},e))})]})]})}),(0,a.jsxs)(B,{className:"border-t p-6 pt-4",children:[(0,a.jsx)(i.z,{variant:"outline",onClick:()=>H(!1),children:"Cancel"}),(0,a.jsx)(i.z,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>{if(!L||!ee){t({title:"Date or Time Missing",description:"Please select both a date and a time for your event.",variant:"destructive"});return}el&&en({...el,eventDate:(0,ec.WU)(L,"PPP"),eventTime:ee}),H(!1),ea(!0)},disabled:!L||!ee,children:"Confirm Date & Time"})]})]})}),(0,a.jsx)(I,{open:et,onOpenChange:ea,children:(0,a.jsxs)(E,{className:"sm:max-w-[525px] flex flex-col max-h-[85vh] overflow-hidden",children:[(0,a.jsxs)(Z,{className:"shrink-0 p-6 pb-4 border-b",children:[(0,a.jsx)(M,{className:"font-headline text-primary",children:"Customer Details"}),(0,a.jsx)(T,{children:"Please fill in your details. All fields marked with * are required."}),(null==el?void 0:el.eventDate)&&(null==el?void 0:el.eventTime)&&(0,a.jsxs)("div",{className:"text-sm text-muted-foreground mt-2",children:["Event scheduled for: ",(0,a.jsxs)("strong",{children:[el.eventDate," at ",el.eventTime]})]})]}),(0,a.jsx)("div",{className:"flex-grow min-h-0 overflow-y-auto",children:(0,a.jsx)(Q,{onSubmit:e=>{if(!el){t({title:"Error",description:"Event configuration is missing. Please try again.",variant:"destructive"});return}ex(e),ea(!1),ep(!0)},onCancel:()=>{ea(!1)},eventTime:ee})})]})}),el&&er&&(0,a.jsx)(ei,{isOpen:eh,onClose:()=>{A(null),D([]),R({}),U({}),en(null),K(void 0),es(void 0),ex(null),ep(!1)},totalAmount:el.totalPrice,eventDate:el.eventDate,eventTime:el.eventTime,customerName:er.fullName,customerPhone:er.phone,customerEmail:er.email,onSubmitProof:eF})]})}},8916:function(e,s,t){"use strict";t.d(s,{Z:function(){return n}});var a=t(7437),l=t(3448);function n(e){let{as:s="h2",className:t,children:n,...r}=e;return(0,a.jsx)(s,{className:(0,l.cn)("font-headline text-3xl md:text-4xl font-bold text-primary mb-6 tracking-tight text-center",t),...r,children:n})}},7168:function(e,s,t){"use strict";t.d(s,{SP:function(){return c},dr:function(){return o},mQ:function(){return i},nU:function(){return d}});var a=t(7437),l=t(2265),n=t(1312),r=t(3448);let i=n.fC,o=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.aV,{ref:s,className:(0,r.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...l})});o.displayName=n.aV.displayName;let c=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.xz,{ref:s,className:(0,r.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...l})});c.displayName=n.xz.displayName;let d=l.forwardRef((e,s)=>{let{className:t,...l}=e;return(0,a.jsx)(n.VY,{ref:s,className:(0,r.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...l})});d.displayName=n.VY.displayName}},function(e){e.O(0,[708,107,878,972,83,594,9,74,362,292,585,971,117,744],function(){return e(e.s=8520)}),_N_E=e.O()}]);